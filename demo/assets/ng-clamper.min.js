/*
ng-clamper - git@github.com:kevinchappell/ng-clamper.git
Version: 0.0.1
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
angular.module("ng-clamper",[]).directive("ngClamper",function(){"use strict";return{scope:{ngModel:"=clamper"},restrict:"C",controller:"clamperCtrl as clamper"}}).controller("clamperCtrl",["$scope","$element",function(e,t){"use strict";function n(){var e=c.text,t=c.ngModel.end||"&hellip;",n=parseInt(c.ngModel.clamp,10),o=window.getComputedStyle(r[0],null).getPropertyValue("line-height").replace("px",""),a=function(){return{current:r[0].clientHeight||r[0].offsetHeight,closed:o*parseInt(c.ngModel.clamp,10)}},p=function(){return Math.max(Math.ceil(a().current/o),0)},g=function(){return p()>n},i=function(e){for(var n=e.length-1;g();n--)r[0].innerHTML=l.strTruncate(e,n,t)};e&&(r[0].innerHTML=e,c.ngModel.clamped===!1&&(c.ngModel.clamped=g()),i(e),c.ngModel.clampOpen?r.css({"max-height":"999px",overflow:"auto"}):r.css({"max-height":a().closed+"px",overflow:"hidden"}))}var l=this,r=t,c=e;c.text=c.ngModel.text||r.text(),l.strTruncate=function(e,t,n){var l=e.length>t,r=l?e.substr(0,t-1):e,c=r.substring(0,Math.min(r.length,r.lastIndexOf(" ")));return c+n},c.ngModel.clamped=!1,c.$watch("ngModel.clamp",n),c.$watch("text",n)}]).directive("clampToggle",function(){"use strict";return{restrict:"E",scope:{ngModel:"="},controller:"clampToggleCtrl as clampToggle"}}).controller("clampToggleCtrl",["$scope","$element",function(e,t){"use strict";function n(){r.ngModel.clampOpen?r.ngModel.clamp=r.ngModel.clampTo:r.ngModel.clamp=r.ngModel.maxClamp,r.ngModel.clampOpen=!r.ngModel.clampOpen}var l=t,r=e;l.bind("click",function(){r.$apply(n)})}]);