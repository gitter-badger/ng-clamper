/*
ng-clamper - git@github.com:kevinchappell/ng-clamper.git
Version: 0.0.1
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
angular.module("ng-clamper",[]).directive("ngClamper",function(){"use strict";return{scope:{ngModel:"=clamper",text:"="},restrict:"C",controller:"clamperCtrl as clamper"}}).controller("clamperCtrl",function(e,n){"use strict";function t(){var e=c.text,n=c.ngModel.end||"&hellip;",t=parseInt(c.ngModel.clamp,10),o=window.getComputedStyle(r[0],null).getPropertyValue("line-height").replace("px",""),a=function(){return{current:r[0].clientHeight||r[0].offsetHeight,closed:o*parseInt(c.ngModel.clamp,10)}},p=function(){return Math.max(Math.ceil(a().current/o),0)},g=function(){return p()>t},i=function(e){for(var t=e.length-1;g();t--)r[0].innerHTML=l.strTruncate(e,t,n)};e&&(r[0].innerHTML=e,c.ngModel.clamped===!1&&(c.ngModel.clamped=g()),i(e),c.ngModel.clampOpen?r.css("max-height","999px"):r.css("max-height",a().closed+"px"))}var l=this,r=n,c=e;l.strTruncate=function(e,n,t){var l=e.length>n,r=l?e.substr(0,n-1):e,c=r.substring(0,Math.min(r.length,r.lastIndexOf(" ")));return c+t},c.ngModel.clamped=!1,c.$watch("ngModel.clamp",t),c.$watch("text",t)}).directive("clampToggle",function(){"use strict";return{restrict:"E",scope:{ngModel:"="},controller:"clampToggleCtrl as clampToggle"}}).controller("clampToggleCtrl",function(e,n){"use strict";function t(){r.ngModel.clampOpen?r.ngModel.clamp=r.ngModel.clampTo:r.ngModel.clamp=r.ngModel.maxClamp,r.ngModel.clampOpen=!r.ngModel.clampOpen}var l=n,r=e;l.bind("click",function(){r.$apply(t)})});