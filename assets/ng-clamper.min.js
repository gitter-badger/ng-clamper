/*
ng-clamper - git@github.com:kevinchappell/ng-clamper.git
Version: 0.1.0
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
angular.module("ng-clamper",[]).directive("ngClamper",function(){"use strict";return{scope:{ngModel:"=ngModel",text:"=text"},restrict:"C",controller:"clamperCtrl as clamper"}}).controller("clamperCtrl",["$scope","$element","$timeout",function(e,t,n){"use strict";var l=this,r=t,c=e,o=c.ngModel.clamp;n(function(){function e(){var e=c.ngModel.end||"&hellip;",t=parseInt(c.ngModel.clamp,10),o=window.getComputedStyle(r[0],null).getPropertyValue("line-height").replace("px",""),a=function(){return{current:r[0].clientHeight||r[0].offsetHeight,closed:o*parseInt(c.ngModel.clamp,10)}},d=function(){return Math.max(Math.ceil(a().current/o),0)},i=function(){return d()>t},g=function(t){for(var n=t.length-1;i();n--)r[0].innerHTML=l.strTruncate(t,n,e)};n&&(r[0].innerHTML=n,c.ngModel.clamped===!1&&(c.ngModel.clamped=i()),g(n),c.ngModel.clamped?r.css({"max-height":"999px",overflow:"auto"}):r.css({"max-height":a().closed+"px",overflow:"hidden"}))}function t(){c.ngModel.clamped?c.ngModel.clamp=1e3:c.ngModel.clamp=o,c.ngModel.clamped=!c.ngModel.clamped}var n=c.text||c.ngModel.text||r.text();l.strTruncate=function(e,t,n){var l=e.length>t,r=l?e.substr(0,t-1):e,c=r.substring(0,Math.min(r.length,r.lastIndexOf(" ")));return c+n},c.ngModel.clamped=!1,c.$watch("ngModel",e,!0),c.$watch("text",e),r.bind("click",function(){c.$apply(t)})},200)}]);